<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>***zoolog***:  
 Zooarcheological Analysis with Log-Ratios • zoolog</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="***zoolog***:  
 Zooarcheological Analysis with Log-Ratios">
<meta property="og:description" content="zoolog">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zoolog</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html">***zoolog***:  
 Zooarcheological Analysis with Log-Ratios</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="index_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<strong><em>zoolog</em></strong>:<br>
Zooarcheological Analysis with Log-Ratios</h1>
                        <h4 class="author">Jose M Pozo, Silvia Valenzuela-Lamas, Angela Trentacoste, Ariadna Nieto-Espinet and Silvia Guimarães Chiarelli</h4>
            
            <h4 class="date">2021-02-02</h4>
      
      
      <div class="hidden name"><code>index.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The package <strong><em>zoolog</em></strong> includes functions and reference data to generate and manipulate log-ratios (also known as log size index (LSI) values) from measurements obtained on zooarchaeological material. Log ratios are used to compare the relative (rather than the absolute) dimensions of animals from archaeological contexts <span class="citation">(Meadow 1999)</span>. Essentially, the method compares archaeological measurements to a standard, producing a value that indicates how much larger or smaller the archaeological specimen is compared to that standard.</p>
<p>The methods included in the package were first developed in the framework of the ERC-Starting Grant 716298 ZooMWest (PI S. Valenzuela-Lamas), and were first used in the paper <span class="citation">(Trentacoste, Nieto-Espinet, and Valenzuela-Lamas 2018)</span>. They are based on the techniques proposed by <span class="citation">(Simpson 1941)</span> and <span class="citation">(Simpson, Roe, and Lewontin 1960)</span>, which calculates LSI values as such:</p>
<p>LSI (log size index) = (log x - log m) = log(x/m)</p>
<p>The zoolog package is based on the measurements and measurement abbreviations defined in <span class="citation">(Von den Driesch 1976)</span> and <span class="citation">(Davis 1992)</span>. Several different sets of standard reference values for calculating the log ratios are included in the package. These standards include several published and widely used biometric datasets (i.e. <span class="citation">(Davis 1996)</span>, <span class="citation">(Albarella and Payne 2005)</span>) as well as other less known standards. We are particularly grateful to Sabine Deschler-Erb and Barbara Stopp, from the University of Basel (Switzerland) for making the reference values of several specimens available through the ICAZ Roman Period Working Group, which have been included here with their permission.</p>
<p>In general, zooarcheological datasets are composed of skeletal remains representing many different anatomical body parts. In investigation of animal size, the analysis of measurements from a given anatomical element provides the best control for the variables affecting size and shape and, as such, it is the preferable option. Unfortunately, this approach is not always viable due to low sample sizes in some archaeological assemblages. This problem can be mitigated by calculating the LSI values for measurements with respect to a reference, which provides a means of aggregating biometric information from different body parts. The resulting log ratios can be compared and statistically analysed under reasonable conditions <span class="citation">(Albarella 2002)</span>. However, length and width measurements of different anatomical elements still should not be directly compared or aggregated for statistical analysis.</p>
<p>The package includes a Thesaurus to facilitate its usage by research teams across the globe, and working in different languages and with different recording traditions. The Thesaurus enables the <em>zoolog</em> package to recognises many different names for taxa and skeletal elements (e.g. “Bos taurus”, “Bos”, “BT”, “bovino”, “bota”). Consequently, there is no need to use a particular, standardised recording code for the names of different taxa or elements.</p>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>The thesaurus has benefited from the contributions from Moussab Besso, Canan Cakirlar, Jwana Chahoud, Jacopo De Grossi Mazzorin, Sabine Deschler-Erb, Dimitrios Filioglou, Armelle Gardeisen, Sierra Harding, Pilar Iborra, Michael MacKinnon, Nimrod Marom, Claudia Minniti, Francesca Slim, Barbara Stopp, and Emmanuelle Vila.</p>
<p>The references’ database includes contributions from Sabine Deschler-Erb, Barbara Stopp, Francesca Slim, and Dimitris Filioglou.</p>
<p>We are grateful to all of them for their contributions, comments, and help. In addition, users are encouraged to contribute to the thesaurus and other references so that <em>zoolog</em> can be expanded and adapted to any database.</p>
</div>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>You can install the released version of zoolog from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"zoolog"</span><span class="op">)</span></code></pre></div>
<p>And the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">devtools</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"josempozo/zoolog@HEAD"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="reference" class="section level1">
<h1 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h1>
<p>The log-ratios are calculated with respect to a standard reference. The package <strong>zoolog</strong> includes three reference datasets. In addition, the user can consider other references, or the provided references can be extended and updated integrating newer research data. Submission of extended/improved references is encouraged. Please, contact the maintainer through the provided email address to make the new reference fully accessible.</p>
<p>The references are provided as dataframes named <code>Reference$NietoAlbarellaDavis</code>, <code>Reference$Basel</code>, and <code>Reference$Combi</code>. They include reference values for the main domesticates and red deer: <em>Bos taurus</em>, <em>Ovis aries</em>, <em>Capra hircus</em>, <em>Sus domesticus</em>, and <em>Cervus elaphus</em>:</p>
<ul>
<li><p><strong>Reference$NietoDavisAlbarella</strong> Includes the measurements from a female cow from Late Neolithic Minferri in Catalonia <span class="citation">(“Element Measure Standard Biometrical Data from a Cow Dated to the Early Bronze Age (Minferri, Catalonia),” n.d.)</span>, the mean values of the adult female Shetland sheep measurements described in <span class="citation">(Davis 1996)</span>, and the pig measurements from <span class="citation">(Albarella and Payne 2005)</span>.</p></li>
<li><p><strong>Reference$Basel</strong> Includes the measurements compiled by Barbara Stopp from the reference collection in the Integrative Prähistorische und Naturwissenschaftliche Archäologie (IPNA, University of Basel, Switzerland). The specimens included are: <em>Bos taurus</em> Inv.nr. 2426 (Hinterwälder; female; 17 years old; live weight: 340 kg; withers height: 113 cm), <em>Ovis musimon</em> Inv.nr. 2266 (Male; adult), <em>Capra hircus</em> Inv.nr. 1597 (Male; adult), <em>Sus scrofa</em> Inv.nr. 1446 (male; 2-3 years old; life weight: 120 kg), <em>Cervus elaphus</em> Inv.nr. 2271 (male; adult).</p></li>
<li><p><strong>Reference$Combi</strong> Includes the most comprehensive reference for each species so more measurements can be considered: the Late Neolithic female cow from Minferri site in present-day Catalonia <span class="citation">(“Element Measure Standard Biometrical Data from a Cow Dated to the Early Bronze Age (Minferri, Catalonia),” n.d.)</span>, the mean measurements from the Male Soay sheep (of known age) and mean measurements from male/female goats (age unknown) from <span class="citation">(Clutton-Brock et al. 1990)</span>, the pig measurements from Inv.nr. 1446 (male; 2-3 years old; life weight: 120 kg) from IPNA-Basel, and the red deer measurements from Inv.nr.2271 at IPNA-Basel registered by Barbara Stopp.</p></li>
</ul>
<p>The details of the reference data are described in <a href="../help/referencesDatabase">References</a>.</p>
</div>
<div id="functions" class="section level1">
<h1 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h1>
<p>The full list of functions is available under the ‘Help’ page of zoolog. Here we present the three main ones and describe their use:</p>
<ul>
<li><p><a href="../help/LogRatios"><strong>LogRatios</strong></a> This function computes the log ratios of the measurements relative to standard reference values. Three references are provided with the package. By default the ‘Reference$Combi’ is used, as it is the most comprehensive so far. The function includes the option to ‘joinCategories’ allowing several taxa (typically Ovis, Capra, and unknown Ovis/Capra) to be considered together.</p></li>
<li><p><a href="../help/RemoveNACases"><strong>RemoveNACases</strong></a> This function removes the table rows for which all measurements of interest are non-available (NA). A particular list of measurement names can be explicitly provided or selected by a common initial pattern (e.g. prefix). The default setting removes the rows with no available log ratios to facilitate subsequent analysis of the data.</p></li>
<li><p><a href="../help/CondenseLogs"><strong>CondenseLogs</strong></a> This function condenses the calculated log ratio values into a reduced number of features by grouping log ratio values and selecting or calculating a feature value. By default the selected groups represent a single dimension, i.e. <code>Length</code> and <code>Width</code>. Only one feature is extracted per group. Currently, two methods are possible: “priority” (default) or “average”. This operation is motivated by two circumstances. First, not all measurements are available for every bone specimen, which obstructs their direct comparison and statistical analysis. Second, several measurements can be strongly correlated (e.g. SD and Bd both represent bone width). Thus, considering them as independent would produce an over-representation of bone remains with multiple measurements per axis. Condensing each group of measurements into a single feature (e.g. one measure per axis) alleviates both problems. The default method (“priority”), selects the first available log ratio in each group. We provide the following by-default group and prioritization: For lengths, the first option is GL, then HTC. For widths, the order of priority is: Bd, BT, Bp, SD. This order maximises the robustness and reliability of the measurements, as priority is given to the most abundant, more replicable, and less age dependent measurements.The method ‘average’ extracts the mean per group, ignoring the non-available log ratios.</p></li>
</ul>
</div>
<div id="thesaurus" class="section level1">
<h1 class="hasAnchor">
<a href="#thesaurus" class="anchor"></a>Thesaurus</h1>
<p>A <a href="../help/zoologThesaurus">thesaurus set</a> is defined in order to make the methods robust to different nomenclatures used in datasets created by different authors and in different languages. The user can also use other thesaurus sets, or can modify the provided one. In this latter case, please, contact the maintainer at the provided email address so that the additions can be incorporated into the new versions of the package. Your name will be added to the list of contributors, as you will help to make the package more robust and comprehensive.</p>
<p>So far, four thesauri are included in <strong>zoolog</strong>:</p>
<ul>
<li><p><strong><code>identifierThesaurus</code></strong> refers to the column names that will be considered to calculate the log ratios. So far, it includes the categories ‘Taxon’, ‘Element’, ‘Measure’, and ‘Standard’. Each of these categories has different options (e.g.: ‘Taxon’ includes Taxon, TAX, species, animal, Specie, GenusSpecies, Especie, see below). This enables the <code>LogRatios</code> function to recognise the relevant column and compute the log ratios regardless of its name as long as it is included in the relevant Thesaurus (<code>taxonThesaurus</code>, <code>elementThesaurus</code>, <code>measureThesaurus</code>).</p></li>
<li><p><strong><code>taxonThesaurus</code></strong> refers to the various possibilities for naming taxa when recording animal bones. This enables the <code>LogRatios</code> function to recognise the name of each species and to find the relevant biometrical reference no matter what it is called in the database and the reference file (e.g. if in the user database, ‘BT’ refers to Bos taurus, but this is written ‘bota’ in the osteometrical reference). The <code>LogRatios</code> function correctly matches these terms because both names (‘BT’ and ‘bota’) are included in the ‘Bos taurus’ category of the <code>taxonThesaurus</code>. To facilitate the comparison of names, the function has been made case, punctuation and spacing insensitive by default (‘Bos’ is considered same as ‘bos’ and ‘Bos.’). You can see the categories currently included as follows:</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">zoolog</span><span class="op">)</span>
<span class="va">thesaurusFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"taxonThesaurus.csv"</span>, package<span class="op">=</span><span class="st">"zoolog"</span><span class="op">)</span>
<span class="va">thesaurusTax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Thesaurus%20Reader/Writer.html">ReadThesaurus</a></span><span class="op">(</span><span class="va">thesaurusFile</span><span class="op">)</span>
<span class="va">thesaurusTax</span>
<span class="co">#&gt;              bos taurus bos primigenius         ovis aries ovis orientalis</span>
<span class="co">#&gt; 1            bos taurus bos primigenius         ovis aries ovis orientalis</span>
<span class="co">#&gt; 2                  bota              BP               ovar    ovis musimon</span>
<span class="co">#&gt; 3                   bos        bos prim               ovis          muflon</span>
<span class="co">#&gt; 4                cattle          auroch              sheep         mouflon</span>
<span class="co">#&gt; 5                    BT            urus                 OA                </span>
<span class="co">#&gt; 6                bovino             ure              oveja                </span>
<span class="co">#&gt; 7  Grands Bovides Boeuf             uro Ovicaprines Mouton                </span>
<span class="co">#&gt; 8                  vaca         auroque                 ov                </span>
<span class="co">#&gt; 9                     B                             ovella                </span>
<span class="co">#&gt; 10                                                     OVA                </span>
<span class="co">#&gt; 11                                                                        </span>
<span class="co">#&gt;    capra hircus  capra aegagrus             ovis/capra sus domesticus</span>
<span class="co">#&gt; 1  capra hircus  capra aegagrus             ovis/capra sus domesticus</span>
<span class="co">#&gt; 2          cahi       wild goat                     oc           sudo</span>
<span class="co">#&gt; 3         capra  cabra salvatge                caprine            sus</span>
<span class="co">#&gt; 4          goat cabra selvagem                     s/g            pig</span>
<span class="co">#&gt; 5            CH   cabra salvaje             sheep/goat             SS</span>
<span class="co">#&gt; 6         cabra  chevre sauvage                   Sh/G          cerdo</span>
<span class="co">#&gt; 7        pecora                             ovicaprino    Suides Porc</span>
<span class="co">#&gt; 8         cabra                                    O/C           porc</span>
<span class="co">#&gt; 9           CAH                 Ovicaprines Ovis-Capra               </span>
<span class="co">#&gt; 10                                            ovicapri               </span>
<span class="co">#&gt; 11                                                   O               </span>
<span class="co">#&gt;      sus scrofa cervus elaphus</span>
<span class="co">#&gt; 1    sus scrofa cervus elaphus</span>
<span class="co">#&gt; 2     wild boar           ceel</span>
<span class="co">#&gt; 3       senglar         cervus</span>
<span class="co">#&gt; 4  porc senglar       red deer</span>
<span class="co">#&gt; 5        jabali             CE</span>
<span class="co">#&gt; 6        javali         ciervo</span>
<span class="co">#&gt; 7      sanglier  Cervides Cerf</span>
<span class="co">#&gt; 8           wss            CEE</span>
<span class="co">#&gt; 9                       cervol</span>
<span class="co">#&gt; 10                      ciervo</span>
<span class="co">#&gt; 11</span></code></pre></div>
<ul>
<li>
<strong><code>elementThesaurus</code></strong> refers to the various possibilities for naming anatomical elements when recording animal bones. This enables the <code>LogRatios</code> function to recognise the name of each element and to find the relevant biometrical reference regardless of what it is called in the database and the reference file (e.g. if in the user database, ‘omero’ refers to humerus, but this is written ‘HU’ in the osteometrical reference). The <code>LogRatios</code> function correctly matches these terms because both categories (‘omero’ and ‘HU’) are included in the ‘humerus’ category of the <code>elementThesaurus</code>. To facilitate the comparison of names, the function has been made case, quotation and spacing insensitive by default (‘Hum’ is considered same as ‘hum’ and ‘Hum.’). You can see the categories currently included as follows:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thesaurusFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"elementThesaurus.csv"</span>, package<span class="op">=</span><span class="st">"zoolog"</span><span class="op">)</span>
<span class="va">thesaurusEL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Thesaurus%20Reader/Writer.html">ReadThesaurus</a></span><span class="op">(</span><span class="va">thesaurusFile</span><span class="op">)</span>
<span class="va">thesaurusEL</span>
<span class="co">#&gt;     scapula                  humerus                  radius    ulna</span>
<span class="co">#&gt; 1   scapula                  humerus                  radius    ulna</span>
<span class="co">#&gt; 2        SC                       HU                      RA   cubit</span>
<span class="co">#&gt; 3   scapula                      hum                     rad  cubito</span>
<span class="co">#&gt; 4   scapola                  Humerus                    radi cubitus</span>
<span class="co">#&gt; 5       esc                    humer                   radio        </span>
<span class="co">#&gt; 6     scap.                    omero Membre-anterieur radius        </span>
<span class="co">#&gt; 7    escap. Membre-anterieur humerus                                </span>
<span class="co">#&gt; 8  Escapula                   Humero                                </span>
<span class="co">#&gt; 9                                                                   </span>
<span class="co">#&gt; 10                                                                  </span>
<span class="co">#&gt; 11                                                                  </span>
<span class="co">#&gt; 12                                                                  </span>
<span class="co">#&gt; 13                                                                  </span>
<span class="co">#&gt; 14                                                                  </span>
<span class="co">#&gt; 15                                                                  </span>
<span class="co">#&gt; 16                                                                  </span>
<span class="co">#&gt; 17                                                                  </span>
<span class="co">#&gt; 18                                                                  </span>
<span class="co">#&gt; 19                                                                  </span>
<span class="co">#&gt;         metacarpus metacarpus II metacarpus III metacarpus IV metacarpus V</span>
<span class="co">#&gt; 1       metacarpus metacarpus II metacarpus III metacarpus IV metacarpus V</span>
<span class="co">#&gt; 2     metacarpal I metacarpal II metacarpal III metacarpal IV metacarpal V</span>
<span class="co">#&gt; 3             MC I         MC II         MC III         MC IV         MC V</span>
<span class="co">#&gt; 4         metac. I     metac. II     metac. III     metac. IV     metac. V</span>
<span class="co">#&gt; 5              MC1           MC2            MC3           MC4          MC5</span>
<span class="co">#&gt; 6      metacarpo I  metacarpo II  metacarpo III  metacarpo IV  metacarpo V</span>
<span class="co">#&gt; 7       metacarp I   metacarp II   metacarp III   metacarp IV   metacarp V</span>
<span class="co">#&gt; 8     metacarpus I                                                        </span>
<span class="co">#&gt; 9  Metacarpe Canon                                                        </span>
<span class="co">#&gt; 10      metacarpal                                                        </span>
<span class="co">#&gt; 11              MC                                                        </span>
<span class="co">#&gt; 12           metac                                                        </span>
<span class="co">#&gt; 13       metacarpo                                                        </span>
<span class="co">#&gt; 14        metacarp                                                        </span>
<span class="co">#&gt; 15                                                                        </span>
<span class="co">#&gt; 16                                                                        </span>
<span class="co">#&gt; 17                                                                        </span>
<span class="co">#&gt; 18                                                                        </span>
<span class="co">#&gt; 19                                                                        </span>
<span class="co">#&gt;        pelvis                   femur                   tibia       calcaneum</span>
<span class="co">#&gt; 1      pelvis                   femur                   tibia       calcaneum</span>
<span class="co">#&gt; 2          PE                      FE                      TI             CAL</span>
<span class="co">#&gt; 3       coxal                     fem                     TIB           calca</span>
<span class="co">#&gt; 4         cox                  femore Membre-posterieur tibia         Calcani</span>
<span class="co">#&gt; 5  innominate Membre-posterieur Femur                                  calcan</span>
<span class="co">#&gt; 6                                                                    calcagno</span>
<span class="co">#&gt; 7                                                             Tarse calcaneum</span>
<span class="co">#&gt; 8                                                                   Calcaneus</span>
<span class="co">#&gt; 9                                                                          CA</span>
<span class="co">#&gt; 10                                                                   calcaneo</span>
<span class="co">#&gt; 11                                                                           </span>
<span class="co">#&gt; 12                                                                           </span>
<span class="co">#&gt; 13                                                                           </span>
<span class="co">#&gt; 14                                                                           </span>
<span class="co">#&gt; 15                                                                           </span>
<span class="co">#&gt; 16                                                                           </span>
<span class="co">#&gt; 17                                                                           </span>
<span class="co">#&gt; 18                                                                           </span>
<span class="co">#&gt; 19                                                                           </span>
<span class="co">#&gt;     astragalus      metatarsus metatarsus II metatarsus III metatarsus IV</span>
<span class="co">#&gt; 1   astragalus      metatarsus metatarsus II metatarsus III metatarsus IV</span>
<span class="co">#&gt; 2           AS    metatarsal I metatarsal II metatarsal III metatarsal IV</span>
<span class="co">#&gt; 3        talus            MT I         MT II         MT III         MT IV</span>
<span class="co">#&gt; 4          AST        metat. I     metat. II     metat. III     metat. IV</span>
<span class="co">#&gt; 5    astragalo             MT1           MT2            MT3           MT4</span>
<span class="co">#&gt; 6       astrag     metatarso I  metatarso II  metatarso III  metatarso IV</span>
<span class="co">#&gt; 7  Tarse Talus      metatars I   metatars II   metatars III   metatars IV</span>
<span class="co">#&gt; 8     astragal    metatarsus I                                           </span>
<span class="co">#&gt; 9              Metatarse Canon                                           </span>
<span class="co">#&gt; 10                  metatarsal                                           </span>
<span class="co">#&gt; 11                          MT                                           </span>
<span class="co">#&gt; 12                       metat                                           </span>
<span class="co">#&gt; 13                   metatarso                                           </span>
<span class="co">#&gt; 14                    metatars                                           </span>
<span class="co">#&gt; 15                                                                       </span>
<span class="co">#&gt; 16                                                                       </span>
<span class="co">#&gt; 17                                                                       </span>
<span class="co">#&gt; 18                                                                       </span>
<span class="co">#&gt; 19                                                                       </span>
<span class="co">#&gt;    metatarsus V  centrotarsale anterior first phalanx       first phalanx</span>
<span class="co">#&gt; 1  metatarsus V  centrotarsale anterior first phalanx       first phalanx</span>
<span class="co">#&gt; 2  metatarsal V   centrotarsal         Phalange 1 ant          Phalange 1</span>
<span class="co">#&gt; 3          MT V escafocuboideo         Phalanx 1 ant.           Phalanx 1</span>
<span class="co">#&gt; 4      metat. V                                P1 ant                  P1</span>
<span class="co">#&gt; 5           MT5                         falange 1 ant           falange 1</span>
<span class="co">#&gt; 6   metatarso V                                  PH1A                 PH1</span>
<span class="co">#&gt; 7    metatars V                            phal 1 ant              phal 1</span>
<span class="co">#&gt; 8                                 Phalange I anterior          Phalange I</span>
<span class="co">#&gt; 9                                            fal1 ant               fal 1</span>
<span class="co">#&gt; 10                                           ant 1fal               1 fal</span>
<span class="co">#&gt; 11                                          ant fal 1 Phalange 1 ant/post</span>
<span class="co">#&gt; 12                                          1 fal ant  Phalanx 1 ant/post</span>
<span class="co">#&gt; 13                                                            P1 ant/post</span>
<span class="co">#&gt; 14                                                     falange 1 ant/post</span>
<span class="co">#&gt; 15                                                           PH1 ant/post</span>
<span class="co">#&gt; 16                                                        phal 1 ant/post</span>
<span class="co">#&gt; 17                                                    Phalange I ant/post</span>
<span class="co">#&gt; 18                                                         fal 1 ant/post</span>
<span class="co">#&gt; 19                                                         1 fal ant/post</span>
<span class="co">#&gt;    posterior first phalanx anterior second phalanx       second phalanx</span>
<span class="co">#&gt; 1  posterior first phalanx anterior second phalanx       second phalanx</span>
<span class="co">#&gt; 2          Phalange 1 post          Phalange 2 ant           Phalange 2</span>
<span class="co">#&gt; 3          Phalanx 1 post.          Phalanx 2 ant.            Phalanx 2</span>
<span class="co">#&gt; 4                  P1 post                  P2 ant                   P2</span>
<span class="co">#&gt; 5           falange 1 post           falange 2 ant            falange 2</span>
<span class="co">#&gt; 6                     PH1P                    PH2A                  PH2</span>
<span class="co">#&gt; 7              phal 1 post              phal 2 ant               phal 2</span>
<span class="co">#&gt; 8          Phalange I post    Phalange II anterior          Phalange II</span>
<span class="co">#&gt; 9                fal1 post                fal2 ant                fal 2</span>
<span class="co">#&gt; 10               post 1fal                ant 2fal                2 fal</span>
<span class="co">#&gt; 11              post fal 1               ant fal 2  Phalange 2 ant/post</span>
<span class="co">#&gt; 12              1 fal post               2 fal ant   Phalanx 2 ant/post</span>
<span class="co">#&gt; 13                                                          P2 ant/post</span>
<span class="co">#&gt; 14                                                   falange 2 ant/post</span>
<span class="co">#&gt; 15                                                         PH2 ant/post</span>
<span class="co">#&gt; 16                                                      phal 2 ant/post</span>
<span class="co">#&gt; 17                                                 Phalange II ant/post</span>
<span class="co">#&gt; 18                                                       fal 2 ant/post</span>
<span class="co">#&gt; 19                                                       2 fal ant/post</span>
<span class="co">#&gt;    posterior second phalanx anterior third phalanx         third phalanx</span>
<span class="co">#&gt; 1  posterior second phalanx anterior third phalanx         third phalanx</span>
<span class="co">#&gt; 2           Phalange 2 post         Phalange 3 ant            Phalange 3</span>
<span class="co">#&gt; 3           Phalanx 2 post.         Phalanx 3 ant.             Phalanx 3</span>
<span class="co">#&gt; 4                   P2 post                 P3 ant                    P3</span>
<span class="co">#&gt; 5            falange 2 post          falange 3 ant             falange 3</span>
<span class="co">#&gt; 6                      PH2P                   PH3A                   PH3</span>
<span class="co">#&gt; 7               phal 2 post             phal 3 ant                phal 3</span>
<span class="co">#&gt; 8     Phalange II posterior  Phalange III anterior          Phalange III</span>
<span class="co">#&gt; 9                fal 2 post               fal3 ant                 fal 3</span>
<span class="co">#&gt; 10                post 2fal               ant 3fal                 3 fal</span>
<span class="co">#&gt; 11               post fal 2              ant fal 3   Phalange 3 ant/post</span>
<span class="co">#&gt; 12               2 fal post              3 fal ant    Phalanx 3 ant/post</span>
<span class="co">#&gt; 13                                                           P3 ant/post</span>
<span class="co">#&gt; 14                                                    falange 3 ant/post</span>
<span class="co">#&gt; 15                                                          PH3 ant/post</span>
<span class="co">#&gt; 16                                                       phal 3 ant/post</span>
<span class="co">#&gt; 17                                                 Phalange III ant/post</span>
<span class="co">#&gt; 18                                                        fal 3 ant/post</span>
<span class="co">#&gt; 19                                                        3 fal ant/post</span>
<span class="co">#&gt;    posterior third phalanx Molar 1 Molar 2 Molar 3 Premolar 1 Premolar 2</span>
<span class="co">#&gt; 1  posterior third phalanx Molar 1 Molar 2 Molar 3 Premolar 1 Premolar 2</span>
<span class="co">#&gt; 2          Phalange 3 post      M1      M2      M3                      </span>
<span class="co">#&gt; 3          Phalanx 3 post.                                              </span>
<span class="co">#&gt; 4                  P3 post                                              </span>
<span class="co">#&gt; 5           falange 3 post                                              </span>
<span class="co">#&gt; 6                     PH3P                                              </span>
<span class="co">#&gt; 7              phal 3 post                                              </span>
<span class="co">#&gt; 8   Phalange III posterior                                              </span>
<span class="co">#&gt; 9               fal 3 post                                              </span>
<span class="co">#&gt; 10               post 3fal                                              </span>
<span class="co">#&gt; 11              post fal 3                                              </span>
<span class="co">#&gt; 12              3 fal post                                              </span>
<span class="co">#&gt; 13                                                                      </span>
<span class="co">#&gt; 14                                                                      </span>
<span class="co">#&gt; 15                                                                      </span>
<span class="co">#&gt; 16                                                                      </span>
<span class="co">#&gt; 17                                                                      </span>
<span class="co">#&gt; 18                                                                      </span>
<span class="co">#&gt; 19                                                                      </span>
<span class="co">#&gt;    lower Molar 1 lower Molar 2 lower Molar 3 lower Premolar 1 lower Premolar 2</span>
<span class="co">#&gt; 1  lower Molar 1 lower Molar 2 lower Molar 3 lower Premolar 1 lower Premolar 2</span>
<span class="co">#&gt; 2            LM1           LM2           LM3                                  </span>
<span class="co">#&gt; 3                                                                             </span>
<span class="co">#&gt; 4                                                                             </span>
<span class="co">#&gt; 5                                                                             </span>
<span class="co">#&gt; 6                                                                             </span>
<span class="co">#&gt; 7                                                                             </span>
<span class="co">#&gt; 8                                                                             </span>
<span class="co">#&gt; 9                                                                             </span>
<span class="co">#&gt; 10                                                                            </span>
<span class="co">#&gt; 11                                                                            </span>
<span class="co">#&gt; 12                                                                            </span>
<span class="co">#&gt; 13                                                                            </span>
<span class="co">#&gt; 14                                                                            </span>
<span class="co">#&gt; 15                                                                            </span>
<span class="co">#&gt; 16                                                                            </span>
<span class="co">#&gt; 17                                                                            </span>
<span class="co">#&gt; 18                                                                            </span>
<span class="co">#&gt; 19</span></code></pre></div>
<ul>
<li>
<strong><code>measureThesaurus</code></strong> refers to the various possibilities for naming measurements. In general, the English abbreviations from <span class="citation">(Von den Driesch 1976)</span> and <span class="citation">(Davis 1992)</span> are widely used. But this enables other nomenclatures (e.g. original German abbreviations in <span class="citation">(Von den Driesch 1976)</span>) to be included, or several measurements to be nested under the same category. In this case, GLl is considered as GL.</li>
</ul>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="reading-data-and-calculating-log-ratios" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-data-and-calculating-log-ratios" class="anchor"></a>Reading data and calculating log ratios</h2>
<p>This example reads a dataset from a file in csv format and computes the log-ratios. Then, the cases with no available log-ratios are removed. Finally, the resulting dataset is saved in a file in csv format.</p>
<p>The first step is to set the local path to the folder where you have the dataset to be analysed (this is typically a comma-separated value (csv) file). Here the example dataset from <span class="citation">(Valenzuela-Lamas 2008)</span> included in the package is used:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">zoolog</span><span class="op">)</span>
<span class="va">dataFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"dataValenzuelaLamas2008.csv.gz"</span>, 
                        package <span class="op">=</span> <span class="st">"zoolog"</span><span class="op">)</span>
<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="va">dataFile</span>,
                 quote<span class="op">=</span><span class="st">"\""</span>, header<span class="op">=</span><span class="cn">TRUE</span>, na<span class="op">=</span><span class="st">""</span>,
                 fileEncoding<span class="op">=</span><span class="st">"UTF-8"</span>,
                 stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>We now calculate the log-ratios using the function <code>LogRatios</code>. Only measurements that have an associated standard will be included in this calculation. The log values will appear as new columns with the prefix ‘log’ following the original columns with the raw measurements:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataWithLog</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogRatios.html">LogRatios</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataWithLog</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;   Site N.inv    UE Especie    Os   GL   Bp   Dp   SD   DD   Bd   Dd BT GLc BFd</span>
<span class="co">#&gt; 1  ALP  3629  8427    avif 1 fal   NA   NA   NA   NA   NA   NA   NA NA  NA  NA</span>
<span class="co">#&gt; 2  ALP  4918 10364    bota 1 fal 54.0 31.3 30.6 28.1 26.3 27.5 20.0 NA  NA  NA</span>
<span class="co">#&gt; 3  ALP  4919 10364    bota 1 fal 54.5 27.9 31.8 26.0 22.8 25.3 19.5 NA  NA  NA</span>
<span class="co">#&gt; 4  ALP  2211  7105    bota 1 fal 47.6 25.2 25.2 20.6 23.7 17.8   NA NA  NA  NA</span>
<span class="co">#&gt; 5  ALP  1257  7093    bota 1 fal 51.1 24.1  2.7 21.5 17.0   NA   NA NA  NA  NA</span>
<span class="co">#&gt; 6  ALP  4693 10258      oc 1 fal 31.0 10.7 12.4   NA  7.4  8.9  8.0 NA  NA  NA</span>
<span class="co">#&gt;   Dl HmandM3 logBd logBFd logBG logBp logBPC logBT logDd logDl logDp logDPA</span>
<span class="co">#&gt; 1 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 2 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 3 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 4 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 5 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 6 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt;   logGB logGL logGLc logGLP logH logL logLA logLAR logLG logSD logSH logSLC</span>
<span class="co">#&gt; 1    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 2    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 3    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 4    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 5    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 6    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span></code></pre></div>
<p>If we observe more carefully the example dataset, we can see that the <em>astragali</em> have been assigned a <em>GL</em> measurement, instead of <em>GLl</em>. For this we can use the function <a href="../help/InCategory">InCategory</a>, which allows to select cases taking into account the thesaurus:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AScases</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InCategory.html">InCategory</a></span><span class="op">(</span><span class="va">dataWithLog</span><span class="op">$</span><span class="va">Os</span>, <span class="st">"talus"</span>, <span class="va">zoologThesaurus</span><span class="op">$</span><span class="va">element</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataWithLog</span><span class="op">[</span><span class="va">AScases</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;      Site N.inv   UE Especie    Os   GL Bp Dp SD DD   Bd Dd BT GLc BFd   Dl</span>
<span class="co">#&gt; 7503  ALP  4410 8001    bota talus 58.4 NA NA NA NA 31.5 NA NA  NA  NA 31.4</span>
<span class="co">#&gt; 7504  ALP  1181 7011    bota talus 57.7 NA NA NA NA 35.7 NA NA  NA  NA 32.8</span>
<span class="co">#&gt; 7505  ALP  1180 7011    bota talus 58.8 NA NA NA NA   NA NA NA  NA  NA   NA</span>
<span class="co">#&gt; 7506  ALP  1136 7039    bota talus 58.9 NA NA NA NA 39.3 NA NA  NA  NA 34.4</span>
<span class="co">#&gt; 7507  ALP  1678 7092    bota talus 59.4 NA NA NA NA 39.8 NA NA  NA  NA 34.9</span>
<span class="co">#&gt; 7508  TFC   617 1061    bota talus 56.6 NA NA NA NA 34.0 NA NA  NA  NA 32.3</span>
<span class="co">#&gt;      HmandM3        logBd logBFd logBG logBp logBPC logBT logDd logDl logDp</span>
<span class="co">#&gt; 7503      NA -0.092754053     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7504      NA -0.038396391     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7505      NA           NA     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7506      NA  0.003327943     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7507      NA  0.008818465     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7508      NA -0.059585690     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt;      logDPA logGB logGL logGLc logGLP logH logL logLA logLAR logLG logSD logSH</span>
<span class="co">#&gt; 7503     NA    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA</span>
<span class="co">#&gt; 7504     NA    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA</span>
<span class="co">#&gt; 7505     NA    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA</span>
<span class="co">#&gt; 7506     NA    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA</span>
<span class="co">#&gt; 7507     NA    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA</span>
<span class="co">#&gt; 7508     NA    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA</span>
<span class="co">#&gt;      logSLC</span>
<span class="co">#&gt; 7503     NA</span>
<span class="co">#&gt; 7504     NA</span>
<span class="co">#&gt; 7505     NA</span>
<span class="co">#&gt; 7506     NA</span>
<span class="co">#&gt; 7507     NA</span>
<span class="co">#&gt; 7508     NA</span></code></pre></div>
<p>This is a dataset simplification that has been used by some researchers. It is possible because <em>GLl</em> is only relevant for the astragalus, while <em>GL</em> is not applicable to it. Thus, there cannot be any ambiguity between both measures since they can be identified by the bone element. However, since the reference uses the proper measure name for each bone element (<em>GLl</em> for the astragalus), the reference measure has not been correctly identified. Consequently, the log ratio <em>logGL</em> has <code>NA</code> values and the column <em>logGLl</em> does not exists.</p>
<p>The optional parameter mergedMeasures facilitates the processing of this type of simplified datasets. For the example data, we can use</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GLandGLl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GL"</span>, <span class="st">"GLl"</span><span class="op">)</span><span class="op">)</span>
<span class="va">dataWithLog</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LogRatios.html">LogRatios</a></span><span class="op">(</span><span class="va">data</span>, mergedMeasures <span class="op">=</span> <span class="va">GLandGLl</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataWithLog</span><span class="op">[</span><span class="va">AScases</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;      Site N.inv   UE Especie    Os   GL Bp Dp SD DD   Bd Dd BT GLc BFd   Dl</span>
<span class="co">#&gt; 7503  ALP  4410 8001    bota talus 58.4 NA NA NA NA 31.5 NA NA  NA  NA 31.4</span>
<span class="co">#&gt; 7504  ALP  1181 7011    bota talus 57.7 NA NA NA NA 35.7 NA NA  NA  NA 32.8</span>
<span class="co">#&gt; 7505  ALP  1180 7011    bota talus 58.8 NA NA NA NA   NA NA NA  NA  NA   NA</span>
<span class="co">#&gt; 7506  ALP  1136 7039    bota talus 58.9 NA NA NA NA 39.3 NA NA  NA  NA 34.4</span>
<span class="co">#&gt; 7507  ALP  1678 7092    bota talus 59.4 NA NA NA NA 39.8 NA NA  NA  NA 34.9</span>
<span class="co">#&gt; 7508  TFC   617 1061    bota talus 56.6 NA NA NA NA 34.0 NA NA  NA  NA 32.3</span>
<span class="co">#&gt;      HmandM3        logBd logBFd logBG logBp logBPC logBT logDd logDl logDp</span>
<span class="co">#&gt; 7503      NA -0.092754053     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7504      NA -0.038396391     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7505      NA           NA     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7506      NA  0.003327943     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7507      NA  0.008818465     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt; 7508      NA -0.059585690     NA    NA    NA     NA    NA    NA    NA    NA</span>
<span class="co">#&gt;      logDPA logGB       logGL logGLc logGLP logH logL logLA logLAR logLG logSD</span>
<span class="co">#&gt; 7503     NA    NA -0.02597884     NA     NA   NA   NA    NA     NA    NA    NA</span>
<span class="co">#&gt; 7504     NA    NA -0.03121588     NA     NA   NA   NA    NA     NA    NA    NA</span>
<span class="co">#&gt; 7505     NA    NA -0.02301436     NA     NA   NA   NA    NA     NA    NA    NA</span>
<span class="co">#&gt; 7506     NA    NA -0.02227639     NA     NA   NA   NA    NA     NA    NA    NA</span>
<span class="co">#&gt; 7507     NA    NA -0.01860524     NA     NA   NA   NA    NA     NA    NA    NA</span>
<span class="co">#&gt; 7508     NA    NA -0.03957526     NA     NA   NA   NA    NA     NA    NA    NA</span>
<span class="co">#&gt;      logSH logSLC</span>
<span class="co">#&gt; 7503    NA     NA</span>
<span class="co">#&gt; 7504    NA     NA</span>
<span class="co">#&gt; 7505    NA     NA</span>
<span class="co">#&gt; 7506    NA     NA</span>
<span class="co">#&gt; 7507    NA     NA</span>
<span class="co">#&gt; 7508    NA     NA</span></code></pre></div>
<p>This option allows to automatically select, for each bone element, the corresponding measure present in the reference. Observe that now the log ratios have been computed and assigned to the column <em>logGL</em>.</p>
</div>
<div id="using-same-ovis-referece-for-all-caprine" class="section level2">
<h2 class="hasAnchor">
<a href="#using-same-ovis-referece-for-all-caprine" class="anchor"></a>Using same ovis referece for all caprine</h2>
<p>We could be interested in obtaining the log ratios of all caprine, including <em>ovis aries</em>, <em>capra hircus</em>, and <em>ovis capra</em>, with respect to the reference for <em>ovis aries</em>. This can be set using the argument <code>joinCategories</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">caprineCategory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ovar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sheep"</span>, <span class="st">"capra"</span>, <span class="st">"oc"</span><span class="op">)</span><span class="op">)</span>
<span class="va">dataWithLog</span><span class="op">=</span><span class="fu"><a href="../reference/LogRatios.html">LogRatios</a></span><span class="op">(</span><span class="va">data</span>, joinCategories <span class="op">=</span> <span class="va">caprineCategory</span>, mergedMeasures <span class="op">=</span> <span class="va">GLandGLl</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataWithLog</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;   Site N.inv    UE Especie    Os   GL   Bp   Dp   SD   DD   Bd   Dd BT GLc BFd</span>
<span class="co">#&gt; 1  ALP  3629  8427    avif 1 fal   NA   NA   NA   NA   NA   NA   NA NA  NA  NA</span>
<span class="co">#&gt; 2  ALP  4918 10364    bota 1 fal 54.0 31.3 30.6 28.1 26.3 27.5 20.0 NA  NA  NA</span>
<span class="co">#&gt; 3  ALP  4919 10364    bota 1 fal 54.5 27.9 31.8 26.0 22.8 25.3 19.5 NA  NA  NA</span>
<span class="co">#&gt; 4  ALP  2211  7105    bota 1 fal 47.6 25.2 25.2 20.6 23.7 17.8   NA NA  NA  NA</span>
<span class="co">#&gt; 5  ALP  1257  7093    bota 1 fal 51.1 24.1  2.7 21.5 17.0   NA   NA NA  NA  NA</span>
<span class="co">#&gt; 6  ALP  4693 10258      oc 1 fal 31.0 10.7 12.4   NA  7.4  8.9  8.0 NA  NA  NA</span>
<span class="co">#&gt;   Dl HmandM3 logBd logBFd logBG logBp logBPC logBT logDd logDl logDp logDPA</span>
<span class="co">#&gt; 1 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 2 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 3 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 4 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 5 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 6 NA      NA    NA     NA    NA    NA     NA    NA    NA    NA    NA     NA</span>
<span class="co">#&gt;   logGB logGL logGLc logGLP logH logL logLA logLAR logLG logSD logSH logSLC</span>
<span class="co">#&gt; 1    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 2    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 3    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 4    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 5    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span>
<span class="co">#&gt; 6    NA    NA     NA     NA   NA   NA    NA     NA    NA    NA    NA     NA</span></code></pre></div>
<p>Note that this option does not remove the distinction in the data between the different species, it just indicates that for these taxa the log ratios must be computed from the same reference (<code>ovar</code>).</p>
</div>
<div id="pruning-the-data-from-cases-with-no-available-measure" class="section level2">
<h2 class="hasAnchor">
<a href="#pruning-the-data-from-cases-with-no-available-measure" class="anchor"></a>Pruning the data from cases with no available measure</h2>
<p>The cases without log-ratios can be removed to facilitate subsequent analyses:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataWithLogPruned</span><span class="op">=</span><span class="fu"><a href="../reference/RemoveNACases.html">RemoveNACases</a></span><span class="op">(</span><span class="va">dataWithLog</span><span class="op">)</span></code></pre></div>
<p>You may want to write the resulting file in the working directory (you need to set it first):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv2</a></span><span class="op">(</span><span class="va">dataWithLogPruned</span>, <span class="st">"myDataWithLogValues.csv"</span>, 
            quote<span class="op">=</span><span class="cn">FALSE</span>, row.names<span class="op">=</span><span class="cn">FALSE</span>, na<span class="op">=</span><span class="st">""</span>, 
            fileEncoding<span class="op">=</span><span class="st">"UTF-8"</span><span class="op">)</span></code></pre></div>
</div>
<div id="condensing-log-values" class="section level2">
<h2 class="hasAnchor">
<a href="#condensing-log-values" class="anchor"></a>Condensing log values</h2>
<p>After calculating log ratios using the <code>LogRatios</code> function, many rows in the resultant dataframe (dataWithLog in the example above) may contain multiple log values, i.e. you will have several log values associated with a particular archaeological specimen. When analysing log ratios, it is preferential to avoid overrepresentation of bones with a greater number of measurements and account for each specimen only once. The <code>CondenseLogs</code> function extracts one length and one width value from each row and places these in new Length and Width columns.The ‘priority’ method described in <span class="citation">(Trentacoste, Nieto-Espinet, and Valenzuela-Lamas 2018)</span> has been set as default. Nevertheless, other options (e.g. average of all width log values for a given specimen) can be chosen if preferred. In this case, the default option has been used:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataWithSummary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CondenseLogs.html">CondenseLogs</a></span><span class="op">(</span><span class="va">dataWithLogPruned</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataWithSummary</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;   Site N.inv    UE Especie       Os   GL   Bp   Dp   SD   DD   Bd Dd BT GLc BFd</span>
<span class="co">#&gt; 1  ALP  3016  8525    ceel     1fal 50.8 17.9 23.4 15.1 17.8 15.2 NA NA  NA  NA</span>
<span class="co">#&gt; 2  ALP  2907  8068    ceel     1fal 52.3 20.1 22.6 15.4  1.7  1.6 NA NA  NA  NA</span>
<span class="co">#&gt; 3  ALP  2906  8068    ceel     1fal 52.9 17.2   NA 14.9 17.7 15.5 NA NA  NA  NA</span>
<span class="co">#&gt; 4  ALP  3453 10410    ovar 1fal ant 27.1  9.9 12.3 17.9  9.0  9.0 NA NA  NA  NA</span>
<span class="co">#&gt; 5  ALP  3455 10410    ovar 1fal ant 27.6  9.6 12.2  7.6  8.9  8.3 NA NA  NA  NA</span>
<span class="co">#&gt; 6  ALP  3524 10122    ovar 1fal ant 27.7  9.2 11.5  7.5  9.4  8.1 NA NA  NA  NA</span>
<span class="co">#&gt;   Dl HmandM3       logBd logBFd logBG       logBp logBPC logBT logDd logDl</span>
<span class="co">#&gt; 1 NA      NA          NA     NA    NA -0.07348283     NA    NA    NA    NA</span>
<span class="co">#&gt; 2 NA      NA          NA     NA    NA -0.02313980     NA    NA    NA    NA</span>
<span class="co">#&gt; 3 NA      NA          NA     NA    NA -0.09080741     NA    NA    NA    NA</span>
<span class="co">#&gt; 4 NA      NA -0.08911977     NA    NA -0.07991177     NA    NA    NA    NA</span>
<span class="co">#&gt; 5 NA      NA -0.12428419     NA    NA -0.09327573     NA    NA    NA    NA</span>
<span class="co">#&gt; 6 NA      NA -0.13487726     NA    NA -0.11175913     NA    NA    NA    NA</span>
<span class="co">#&gt;         logDp logDPA logGB       logGL logGLc logGLP logH logL logLA logLAR</span>
<span class="co">#&gt; 1          NA     NA    NA          NA     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 2          NA     NA    NA          NA     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 3          NA     NA    NA          NA     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 4 -0.07265930     NA    NA -0.10786052     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 5 -0.07620458     NA    NA -0.09992073     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 6 -0.10186657     NA    NA -0.09835005     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt;   logLG      logSD logSH logSLC      Length       Width</span>
<span class="co">#&gt; 1    NA         NA    NA     NA          NA -0.07348283</span>
<span class="co">#&gt; 2    NA         NA    NA     NA          NA -0.02313980</span>
<span class="co">#&gt; 3    NA         NA    NA     NA          NA -0.09080741</span>
<span class="co">#&gt; 4    NA  0.2629585    NA     NA -0.10786052 -0.08911977</span>
<span class="co">#&gt; 5    NA -0.1090810    NA     NA -0.09992073 -0.12428419</span>
<span class="co">#&gt; 6    NA -0.1148333    NA     NA -0.09835005 -0.13487726</span></code></pre></div>
</div>
<div id="examples-of-different-plots-for-data-visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-of-different-plots-for-data-visualisation" class="anchor"></a>Examples of different plots for data visualisation</h2>
<p>Condensed log values can be visualised as histograms and box plots using ggplot <span class="citation">(Wickham 2011)</span>. Here we will look at some examples of plotting values from sheep/goat.</p>
<div id="preparing-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preparing-the-data" class="anchor"></a>Preparing the data</h3>
<p>The integration of the thesaurus functionality facilitates the use of datasets with heterogenous nomenclatures, without further preprocessing. An extensive catalogue of names for equivalent categories have been integrated in the provided thesaurus set <code>zoologThesaurus</code>. These equivalences are internally and silently managed without requiring any action from the user. However, it can be also interesting to explicitly standardize the data to make figures legible to a wider audience. This is especially useful when different nomenclature for the same concept is found in the same dataset, for instance “sheep” and “ovis” for the same taxon or “hum” and “HU” for the bone element.</p>
<p>In the example data, <code>zoologThesaurus</code> will change for instance <code>"ovar"</code> to <code>"ovis aries"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataStandardized</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/StandardizeNomenclature.html">StandardizeDataSet</a></span><span class="op">(</span><span class="va">dataWithSummary</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataStandardized</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;   Site N.inv    UE          Taxon                Element   GL   Bp   Dp   SD</span>
<span class="co">#&gt; 1  ALP  3016  8525 cervus elaphus          first phalanx 50.8 17.9 23.4 15.1</span>
<span class="co">#&gt; 2  ALP  2907  8068 cervus elaphus          first phalanx 52.3 20.1 22.6 15.4</span>
<span class="co">#&gt; 3  ALP  2906  8068 cervus elaphus          first phalanx 52.9 17.2   NA 14.9</span>
<span class="co">#&gt; 4  ALP  3453 10410     ovis aries anterior first phalanx 27.1  9.9 12.3 17.9</span>
<span class="co">#&gt; 5  ALP  3455 10410     ovis aries anterior first phalanx 27.6  9.6 12.2  7.6</span>
<span class="co">#&gt; 6  ALP  3524 10122     ovis aries anterior first phalanx 27.7  9.2 11.5  7.5</span>
<span class="co">#&gt;     DD   Bd Dd BT GLc BFd Dl HmandM3       logBd logBFd logBG       logBp</span>
<span class="co">#&gt; 1 17.8 15.2 NA NA  NA  NA NA      NA          NA     NA    NA -0.07348283</span>
<span class="co">#&gt; 2  1.7  1.6 NA NA  NA  NA NA      NA          NA     NA    NA -0.02313980</span>
<span class="co">#&gt; 3 17.7 15.5 NA NA  NA  NA NA      NA          NA     NA    NA -0.09080741</span>
<span class="co">#&gt; 4  9.0  9.0 NA NA  NA  NA NA      NA -0.08911977     NA    NA -0.07991177</span>
<span class="co">#&gt; 5  8.9  8.3 NA NA  NA  NA NA      NA -0.12428419     NA    NA -0.09327573</span>
<span class="co">#&gt; 6  9.4  8.1 NA NA  NA  NA NA      NA -0.13487726     NA    NA -0.11175913</span>
<span class="co">#&gt;   logBPC logBT logDd logDl       logDp logDPA logGB       logGL logGLc logGLP</span>
<span class="co">#&gt; 1     NA    NA    NA    NA          NA     NA    NA          NA     NA     NA</span>
<span class="co">#&gt; 2     NA    NA    NA    NA          NA     NA    NA          NA     NA     NA</span>
<span class="co">#&gt; 3     NA    NA    NA    NA          NA     NA    NA          NA     NA     NA</span>
<span class="co">#&gt; 4     NA    NA    NA    NA -0.07265930     NA    NA -0.10786052     NA     NA</span>
<span class="co">#&gt; 5     NA    NA    NA    NA -0.07620458     NA    NA -0.09992073     NA     NA</span>
<span class="co">#&gt; 6     NA    NA    NA    NA -0.10186657     NA    NA -0.09835005     NA     NA</span>
<span class="co">#&gt;   logH logL logLA logLAR logLG      logSD logSH logSLC      Length       Width</span>
<span class="co">#&gt; 1   NA   NA    NA     NA    NA         NA    NA     NA          NA -0.07348283</span>
<span class="co">#&gt; 2   NA   NA    NA     NA    NA         NA    NA     NA          NA -0.02313980</span>
<span class="co">#&gt; 3   NA   NA    NA     NA    NA         NA    NA     NA          NA -0.09080741</span>
<span class="co">#&gt; 4   NA   NA    NA     NA    NA  0.2629585    NA     NA -0.10786052 -0.08911977</span>
<span class="co">#&gt; 5   NA   NA    NA     NA    NA -0.1090810    NA     NA -0.09992073 -0.12428419</span>
<span class="co">#&gt; 6   NA   NA    NA     NA    NA -0.1148333    NA     NA -0.09835005 -0.13487726</span></code></pre></div>
<p>We may be interested in selecting all caprine elements. This can be done even without standardizing the data using the function <code>InCategory</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataOC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dataWithSummary</span>, <span class="fu"><a href="../reference/InCategory.html">InCategory</a></span><span class="op">(</span><span class="va">Especie</span>, 
                                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sheep"</span>, <span class="st">"capra"</span>, <span class="st">"oc"</span><span class="op">)</span>,
                                             <span class="va">zoologThesaurus</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataOC</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;   Site N.inv    UE Especie       Os   GL  Bp   Dp   SD  DD  Bd Dd BT GLc BFd Dl</span>
<span class="co">#&gt; 4  ALP  3453 10410    ovar 1fal ant 27.1 9.9 12.3 17.9 9.0 9.0 NA NA  NA  NA NA</span>
<span class="co">#&gt; 5  ALP  3455 10410    ovar 1fal ant 27.6 9.6 12.2  7.6 8.9 8.3 NA NA  NA  NA NA</span>
<span class="co">#&gt; 6  ALP  3524 10122    ovar 1fal ant 27.7 9.2 11.5  7.5 9.4 8.1 NA NA  NA  NA NA</span>
<span class="co">#&gt; 7  ALP  3525 10122    ovar 1fal ant 27.8 9.1 11.3  7.5 9.2 8.2 NA NA  NA  NA NA</span>
<span class="co">#&gt; 8  ALP  3456 10410    ovar 1fal ant 28.0 9.6 12.5  7.8 8.9 8.4 NA NA  NA  NA NA</span>
<span class="co">#&gt; 9  ALP  3522 10122    ovar 1fal ant 28.2 9.3 11.9  7.6 9.1 7.1 NA NA  NA  NA NA</span>
<span class="co">#&gt;   HmandM3       logBd logBFd logBG       logBp logBPC logBT logDd logDl</span>
<span class="co">#&gt; 4      NA -0.08911977     NA    NA -0.07991177     NA    NA    NA    NA</span>
<span class="co">#&gt; 5      NA -0.12428419     NA    NA -0.09327573     NA    NA    NA    NA</span>
<span class="co">#&gt; 6      NA -0.13487726     NA    NA -0.11175913     NA    NA    NA    NA</span>
<span class="co">#&gt; 7      NA -0.12954843     NA    NA -0.11650557     NA    NA    NA    NA</span>
<span class="co">#&gt; 8      NA -0.11908299     NA    NA -0.09327573     NA    NA    NA    NA</span>
<span class="co">#&gt; 9      NA -0.19210393     NA    NA -0.10706401     NA    NA    NA    NA</span>
<span class="co">#&gt;         logDp logDPA logGB       logGL logGLc logGLP logH logL logLA logLAR</span>
<span class="co">#&gt; 4 -0.07265930     NA    NA -0.10786052     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 5 -0.07620458     NA    NA -0.09992073     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 6 -0.10186657     NA    NA -0.09835005     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 7 -0.10948596     NA    NA -0.09678502     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 8 -0.06565439     NA    NA -0.09367178     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt; 9 -0.08701745     NA    NA -0.09058071     NA     NA   NA   NA    NA     NA</span>
<span class="co">#&gt;   logLG       logSD logSH logSLC      Length       Width</span>
<span class="co">#&gt; 4    NA  0.26295847    NA     NA -0.10786052 -0.08911977</span>
<span class="co">#&gt; 5    NA -0.10908097    NA     NA -0.09992073 -0.12428419</span>
<span class="co">#&gt; 6    NA -0.11483330    NA     NA -0.09835005 -0.13487726</span>
<span class="co">#&gt; 7    NA -0.11483330    NA     NA -0.09678502 -0.12954843</span>
<span class="co">#&gt; 8    NA -0.09779996    NA     NA -0.09367178 -0.11908299</span>
<span class="co">#&gt; 9    NA -0.10908097    NA     NA -0.09058071 -0.19210393</span></code></pre></div>
<p>Observe that no standardization is performed in the output subset. To standardize the subset data, <code>StandardizeDataSet</code> can be applied either before or after the subsetting.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataOCStandardized</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/StandardizeNomenclature.html">StandardizeDataSet</a></span><span class="op">(</span><span class="va">dataOC</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataOCStandardized</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">32</span><span class="op">:</span><span class="fl">63</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;   Site N.inv    UE      Taxon                Element   GL  Bp   Dp   SD  DD  Bd</span>
<span class="co">#&gt; 4  ALP  3453 10410 ovis aries anterior first phalanx 27.1 9.9 12.3 17.9 9.0 9.0</span>
<span class="co">#&gt; 5  ALP  3455 10410 ovis aries anterior first phalanx 27.6 9.6 12.2  7.6 8.9 8.3</span>
<span class="co">#&gt; 6  ALP  3524 10122 ovis aries anterior first phalanx 27.7 9.2 11.5  7.5 9.4 8.1</span>
<span class="co">#&gt; 7  ALP  3525 10122 ovis aries anterior first phalanx 27.8 9.1 11.3  7.5 9.2 8.2</span>
<span class="co">#&gt; 8  ALP  3456 10410 ovis aries anterior first phalanx 28.0 9.6 12.5  7.8 8.9 8.4</span>
<span class="co">#&gt; 9  ALP  3522 10122 ovis aries anterior first phalanx 28.2 9.3 11.9  7.6 9.1 7.1</span>
<span class="co">#&gt;   Dd BT GLc BFd Dl HmandM3       logBd logBFd logBG       logBp logBPC logBT</span>
<span class="co">#&gt; 4 NA NA  NA  NA NA      NA -0.08911977     NA    NA -0.07991177     NA    NA</span>
<span class="co">#&gt; 5 NA NA  NA  NA NA      NA -0.12428419     NA    NA -0.09327573     NA    NA</span>
<span class="co">#&gt; 6 NA NA  NA  NA NA      NA -0.13487726     NA    NA -0.11175913     NA    NA</span>
<span class="co">#&gt; 7 NA NA  NA  NA NA      NA -0.12954843     NA    NA -0.11650557     NA    NA</span>
<span class="co">#&gt; 8 NA NA  NA  NA NA      NA -0.11908299     NA    NA -0.09327573     NA    NA</span>
<span class="co">#&gt; 9 NA NA  NA  NA NA      NA -0.19210393     NA    NA -0.10706401     NA    NA</span>
<span class="co">#&gt;   logDd logDl       logDp logDPA logGB       logGL logGLc logGLP logH logL</span>
<span class="co">#&gt; 4    NA    NA -0.07265930     NA    NA -0.10786052     NA     NA   NA   NA</span>
<span class="co">#&gt; 5    NA    NA -0.07620458     NA    NA -0.09992073     NA     NA   NA   NA</span>
<span class="co">#&gt; 6    NA    NA -0.10186657     NA    NA -0.09835005     NA     NA   NA   NA</span>
<span class="co">#&gt; 7    NA    NA -0.10948596     NA    NA -0.09678502     NA     NA   NA   NA</span>
<span class="co">#&gt; 8    NA    NA -0.06565439     NA    NA -0.09367178     NA     NA   NA   NA</span>
<span class="co">#&gt; 9    NA    NA -0.08701745     NA    NA -0.09058071     NA     NA   NA   NA</span>
<span class="co">#&gt;   logLA logLAR logLG       logSD logSH logSLC      Length       Width</span>
<span class="co">#&gt; 4    NA     NA    NA  0.26295847    NA     NA -0.10786052 -0.08911977</span>
<span class="co">#&gt; 5    NA     NA    NA -0.10908097    NA     NA -0.09992073 -0.12428419</span>
<span class="co">#&gt; 6    NA     NA    NA -0.11483330    NA     NA -0.09835005 -0.13487726</span>
<span class="co">#&gt; 7    NA     NA    NA -0.11483330    NA     NA -0.09678502 -0.12954843</span>
<span class="co">#&gt; 8    NA     NA    NA -0.09779996    NA     NA -0.09367178 -0.11908299</span>
<span class="co">#&gt; 9    NA     NA    NA -0.10908097    NA     NA -0.09058071 -0.19210393</span></code></pre></div>
<p>Observe also that the distinction between “ovis aries”, “capra hircus”, and “ovis capra” has not been removed from the data.</p>
<p>For plotting the Width, we can retain the cases including this measure:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataOCWithWidth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RemoveNACases.html">RemoveNACases</a></span><span class="op">(</span><span class="va">dataOCStandardized</span>, measureNames <span class="op">=</span> <span class="st">"Width"</span><span class="op">)</span></code></pre></div>
<p>which gives</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dataOCWithWidth</span><span class="op">)</span>
<span class="co">#&gt; [1] 237</span></code></pre></div>
<p>cases.</p>
<p>For ploting the Length, we can retain the cases including this measure:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataOCWithLength</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RemoveNACases.html">RemoveNACases</a></span><span class="op">(</span><span class="va">dataOCStandardized</span>, measureNames <span class="op">=</span> <span class="st">"Length"</span><span class="op">)</span></code></pre></div>
<p>which gives</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dataOCWithLength</span><span class="op">)</span>
<span class="co">#&gt; [1] 149</span></code></pre></div>
<p>cases.</p>
</div>
<div id="horizontal-boxplot-with-dots" class="section level3">
<h3 class="hasAnchor">
<a href="#horizontal-boxplot-with-dots" class="anchor"></a>Horizontal Boxplot with dots</h3>
<p>For the example plots we will use the package <strong>ggplot2</strong>.</p>
<p>We can now create a boxplot for the widths:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dataOCStandardized</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Width</span>, y<span class="op">=</span><span class="va">Site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_jitter</span><span class="op">(</span>height<span class="op">=</span><span class="fl">.2</span>, width<span class="op">=</span><span class="fl">0</span>, alpha<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, color<span class="op">=</span><span class="fl">4</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Caprine widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Width log-ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;"></p>
<p>And another boxplot for the lengths:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dataOCStandardized</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Length</span>, y<span class="op">=</span><span class="va">Site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_jitter</span><span class="op">(</span>height<span class="op">=</span><span class="fl">.2</span>, width<span class="op">=</span><span class="fl">0</span>, alpha<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, color<span class="op">=</span><span class="fl">4</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Caprine lengths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Length log-ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="histograms" class="section level3">
<h3 class="hasAnchor">
<a href="#histograms" class="anchor"></a>Histograms</h3>
<p>We may choose to plot the width data as an histogram:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dataOCStandardized</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">30</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Caprine widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Width log-ratio"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">Site</span> <span class="op">~</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        panel.grid.minor.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span>,size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,
        axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
        axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
        axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="example-of-statistical-test" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-statistical-test" class="anchor"></a>Example of statistical test</h3>
<p>We may run a statistical test (here a Student t-test) to check whether the differences between sites have statistical significance on lengths:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Length</span> <span class="op">~</span> <span class="va">Site</span>, <span class="va">dataOCStandardized</span>, 
       subset <span class="op">=</span> <span class="va">Site</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OLD"</span>, <span class="st">"ALP"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  Length by Site</span>
<span class="co">#&gt; t = -12.23, df = 4.2233, p-value = 0.0001865</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.11262797 -0.07165242</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group ALP mean in group OLD </span>
<span class="co">#&gt;       -0.04589475        0.04624545</span></code></pre></div>
<p>or on widths:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Width</span> <span class="op">~</span> <span class="va">Site</span>, <span class="va">dataOCStandardized</span>, 
       subset <span class="op">=</span> <span class="va">Site</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OLD"</span>, <span class="st">"ALP"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  Width by Site</span>
<span class="co">#&gt; t = -2.863, df = 8.7789, p-value = 0.01916</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.09379203 -0.01081753</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group ALP mean in group OLD </span>
<span class="co">#&gt;       -0.03553854        0.01676624</span></code></pre></div>
<p>For testing all possible pairs, the p-values must be adjusted for multiple comparisons:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">dataOCStandardized</span><span class="op">$</span><span class="va">Width</span>, <span class="va">dataOCStandardized</span><span class="op">$</span><span class="va">Site</span>, pool.sd <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pairwise comparisons using t tests with non-pooled SD </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  dataOCStandardized$Width and dataOCStandardized$Site </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     ALP   OLD  </span>
<span class="co">#&gt; OLD 0.057 -    </span>
<span class="co">#&gt; TFC 0.138 0.138</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; P value adjustment method: holm</span></code></pre></div>
</div>
<div id="another-visualisation-for-boxplot-with-dots" class="section level3">
<h3 class="hasAnchor">
<a href="#another-visualisation-for-boxplot-with-dots" class="anchor"></a>Another visualisation for boxplot with dots</h3>
<p>Here we reorder the factor levels of <code>dataOCStandardized$Taxon</code> to make the order of the boxplots more intuitive.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">levels0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dataOCStandardized</span><span class="op">$</span><span class="va">Taxon</span><span class="op">)</span>
<span class="va">levels0</span>
<span class="co">#&gt; [1] "capra hircus" "ovis aries"   "ovis/capra"</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataOCStandardized</span><span class="op">$</span><span class="va">Taxon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dataOCStandardized</span><span class="op">$</span><span class="va">Taxon</span>, 
                                   levels <span class="op">=</span> <span class="va">levels0</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dataOCStandardized</span><span class="op">$</span><span class="va">Taxon</span><span class="op">)</span>
<span class="co">#&gt; [1] "ovis aries"   "ovis/capra"   "capra hircus"</span></code></pre></div>
<p>and assign specific colours for each category:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ocolour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#A2A475"</span>, <span class="st">"#D8B70A"</span>, <span class="st">"#81A88D"</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">dataOCStandardized</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Site</span>, y<span class="op">=</span><span class="va">Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">Taxon</span><span class="op">)</span>, 
               notch<span class="op">=</span><span class="cn">TRUE</span>, alpha<span class="op">=</span><span class="fl">0</span>, lwd<span class="op">=</span><span class="fl">0.377</span>, outlier.alpha <span class="op">=</span> <span class="fl">0</span>,
               width <span class="op">=</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>,
               position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>,
               show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour<span class="op">=</span><span class="va">Taxon</span>, shape<span class="op">=</span><span class="va">Taxon</span><span class="op">)</span>, 
             alpha<span class="op">=</span><span class="fl">0.7</span>, size<span class="op">=</span><span class="fl">0.8</span>, 
             position <span class="op">=</span> <span class="fu">position_jitterdodge</span><span class="op">(</span>jitter.width<span class="op">=</span><span class="fl">.3</span><span class="op">)</span>,
             na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_colour_manual</span><span class="op">(</span>values<span class="op">=</span><span class="va">Ocolour</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_shape_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">18</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"LSI value"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Sheep/goat LSI width values"</span><span class="op">)</span> 
<span class="co">#&gt; notch went outside hinges. Try setting notch=FALSE.</span>
<span class="co">#&gt; notch went outside hinges. Try setting notch=FALSE.</span>
<span class="co">#&gt; notch went outside hinges. Try setting notch=FALSE.</span>
<span class="co">#&gt; notch went outside hinges. Try setting notch=FALSE.</span>
<span class="co">#&gt; notch went outside hinges. Try setting notch=FALSE.</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="another-visualisation-for-sheep-and-goat-histograms" class="section level3">
<h3 class="hasAnchor">
<a href="#another-visualisation-for-sheep-and-goat-histograms" class="anchor"></a>Another visualisation for sheep and goat histograms:</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TaxonSiteWidthHist</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dataOCStandardized</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Width</span>, fill<span class="op">=</span><span class="va">Taxon</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">30</span>, alpha<span class="op">=</span><span class="fl">.5</span>, position<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Sheep/goat Widths"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="va">Site</span> <span class="op">~</span> <span class="va">Taxon</span><span class="op">)</span>
<span class="va">TaxonSiteWidthHist</span>
<span class="co">#&gt; Warning: Removed 43 rows containing non-finite values (stat_bin).</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TaxonSiteWidthHist</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dataOCStandardized</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">Width</span>, fill<span class="op">=</span><span class="va">Taxon</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">30</span>, alpha<span class="op">=</span><span class="fl">.5</span>, position<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Sheep/goat Widths"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">Site</span><span class="op">)</span>
<span class="va">TaxonSiteWidthHist</span>
<span class="co">#&gt; Warning: Removed 43 rows containing non-finite values (stat_bin).</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" width="576" style="display: block; margin: auto;"></p>
<div id="refs" class="references">
<div id="ref-albarella2002size">
<p>Albarella, Umberto. 2002. “’Size Matters’: How and Why Biometry Is Still Important in Zooarchaeology, in: Dobney &amp; Connor (Eds.) Bones and the Man. Studies in Honour of Fon Brothwell.” Oxbow Books.</p>
</div>
<div id="ref-albarella2005neolithic">
<p>Albarella, Umberto, and Sebastian Payne. 2005. “Neolithic Pigs from Durrington Walls, Wiltshire, England: A Biometrical Database.” <em>Journal of Archaeological Science</em> 32 (4): 589–99.</p>
</div>
<div id="ref-clutton1990osteology">
<p>Clutton-Brock, J, K Dennis-Bryan, PL Armitage, and PA Jewell. 1990. “Osteology of the Soay Sheep.” <em>Bulletin of the British Museum, Natural History. Zoology</em> 56 (1): 1–56.</p>
</div>
<div id="ref-davis1996measurements">
<p>Davis, Simon JM. 1996. “Measurements of a Group of Adult Female Shetland Sheep Skeletons from a Single Flock: A Baseline for Zooarchaeologists.” <em>Journal of Archaeological Science</em> 23 (4): 593–612.</p>
</div>
<div id="ref-davis1992rapid">
<p>Davis, SJ. 1992. “A Rapid Method for Recording Information About Mammal Bones from Archaeological Sites (Aml Report 19/92; English Heritage).” London.</p>
</div>
<div id="ref-nieto2018element">
<p>“Element Measure Standard Biometrical Data from a Cow Dated to the Early Bronze Age (Minferri, Catalonia).” n.d.</p>
</div>
<div id="ref-meadow1999use">
<p>Meadow, Richard H. 1999. <em>The Use of Size Index Scaling Techniques for Research on Archaeozoological Collections from the Middle East</em>. na.</p>
</div>
<div id="ref-simpson1941large">
<p>Simpson, George Gaylord. 1941. “Large Pleistocene Felines of North America.” <em>American Museum Novitates</em> 1136: 1–27.</p>
</div>
<div id="ref-simpson1960quantitative">
<p>Simpson, GG, A Roe, and RC Lewontin. 1960. “Quantitative Zoology.,(Harcourt, Brace and Co.: New York.).”</p>
</div>
<div id="ref-trentacoste2018pre">
<p>Trentacoste, Angela, Ariadna Nieto-Espinet, and Silvia Valenzuela-Lamas. 2018. “Pre-Roman Improvements to Agricultural Production: Evidence from Livestock Husbandry in Late Prehistoric Italy.” <em>PloS One</em> 13 (12): e0208109.</p>
</div>
<div id="ref-valenzuela2008alimentacio">
<p>Valenzuela-Lamas, Silvia. 2008. <em>Alimentació I Ramaderia Al Penedès Durant La Protohistòria (Segles Vii-Iii aC)</em>.</p>
</div>
<div id="ref-von1976guide">
<p>Von den Driesch, Angela. 1976. <em>A Guide to the Measurement of Animal Bones from Archaeological Sites: As Developed by the Institut Für Palaeoanatomie, Domestikationsforschung Und Geschichte Der Tiermedizin of the University of Munich</em>. Vol. 1. Peabody Museum Press.</p>
</div>
<div id="ref-wickham2011ggplot2">
<p>Wickham, Hadley. 2011. “Ggplot2.” <em>Wiley Interdisciplinary Reviews: Computational Statistics</em> 3 (2): 180–85.</p>
</div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jose M Pozo, Silvia Valenzuela-Lamas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
